<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Momentum - ×‘× ×” ××ª ×¢×¦××š</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(180deg, #2d2d3f 0%, #1a1a2e 100%);
    }
    #root {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    const Storage = {
      get: (key) => {
        if (typeof window === 'undefined') return null;
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : null;
      },
      set: (key, value) => {
        if (typeof window === 'undefined') return;
        localStorage.setItem(key, JSON.stringify(value));
      }
    };

    const initialHabits = [
      { id: 'reading', title: '×§×¨×™××”', icon: '', completed: false },
      { id: 'water', title: '×©×ª×™×™×ª ××™×', icon: '', completed: false },
      { id: 'meals', title: '××¨×•×—×•×ª ××¡×•×“×¨×•×ª', icon: '', completed: false }
    ];

    const taskCategories = [
      { id: 'workout', name: '××™××•×Ÿ', color: '#3b82f6', bgColor: 'linear-gradient(135deg, #3b82f6, #2563eb)' },
      { id: 'learning', name: '×œ××™×“×”', color: '#8b5cf6', bgColor: 'linear-gradient(135deg, #8b5cf6, #7c3aed)' },
      { id: 'work', name: '×¢×‘×•×“×”', color: '#f59e0b', bgColor: 'linear-gradient(135deg, #f59e0b, #d97706)' },
      { id: 'food', name: '××•×›×œ', color: '#10b981', bgColor: 'linear-gradient(135deg, #10b981, #059669)' },
      { id: 'friends', name: '×—×‘×¨×™×', color: '#ec4899', bgColor: 'linear-gradient(135deg, #ec4899, #db2777)' },
      { id: 'leisure', name: '×¤× ××™', color: '#06b6d4', bgColor: 'linear-gradient(135deg, #06b6d4, #0891b2)' },
      { id: 'meditation', name: '××“×™×˜×¦×™×”', color: '#a855f7', bgColor: 'linear-gradient(135deg, #a855f7, #9333ea)' },
      { id: 'reading', name: '×§×¨×™××”', color: '#f97316', bgColor: 'linear-gradient(135deg, #f97316, #ea580c)' },
      { id: 'tv', name: '×˜×œ×•×•×™×–×™×”', color: '#6366f1', bgColor: 'linear-gradient(135deg, #6366f1, #4f46e5)' },
      { id: 'self', name: '×–××Ÿ ×¢×¦××™', color: '#14b8a6', bgColor: 'linear-gradient(135deg, #14b8a6, #0d9488)' },
      { id: 'chores', name: '×¡×™×“×•×¨×™×', color: '#64748b', bgColor: 'linear-gradient(135deg, #64748b, #475569)' }
    ];

    const daysOfWeek = ['×¨××©×•×Ÿ', '×©× ×™', '×©×œ×™×©×™', '×¨×‘×™×¢×™', '×—××™×©×™', '×©×™×©×™', '×©×‘×ª'];

    const getCurrentDay = () => daysOfWeek[new Date().getDay()];

    const initialSchedule = {
      '×¨××©×•×Ÿ': [], '×©× ×™': [], '×©×œ×™×©×™': [], '×¨×‘×™×¢×™': [], '×—××™×©×™': [], '×©×™×©×™': [], '×©×‘×ª': []
    };

    const MomentumLogo = () => (
      <div style={{textAlign: 'center', padding: '15px 0'}}>
        <div style={{maxWidth: '360px', margin: '0 auto'}}>
          <svg width="100%" viewBox="0 0 600 200" xmlns="http://www.w3.org/2000/svg">
            <g transform="translate(150, 20)">
              <path d="M 0,60 L 30,10 L 50,35 L 70,5 L 90,30 L 120,50 L 150,15 L 180,40 L 200,60 L 0,60 Z" 
                    fill="#6b3fa0" 
                    opacity="0.9"/>
            </g>
            <text x="300" y="130" 
                  fontFamily="Impact, Arial Black, sans-serif" 
                  fontSize="65" 
                  fontWeight="900" 
                  fontStyle="italic" 
                  fill="#8b5fbf" 
                  textAnchor="middle" 
                  letterSpacing="-1">
              momentum
            </text>
            <text x="300" y="170" 
                  fontFamily="Arial, sans-serif" 
                  fontSize="20" 
                  fontWeight="900" 
                  letterSpacing="8" 
                  fill="#9ca3af" 
                  textAnchor="middle">
              BUILD YOURSELF
            </text>
          </svg>
        </div>
      </div>
    );

    function App() {
      const [habits, setHabits] = useState(() => Storage.get('habits') || initialHabits);
      const [streak, setStreak] = useState(() => Storage.get('streak') || 0);
      const [level, setLevel] = useState(() => Storage.get('level') || 1);
      const [points, setPoints] = useState(() => Storage.get('points') || 20);
      const [completedToday, setCompletedToday] = useState(0);
      const [currentPage, setCurrentPage] = useState('dashboard');
      const [schedule, setSchedule] = useState(() => Storage.get('schedule') || initialSchedule);
      const [showTaskModal, setShowTaskModal] = useState(false);
      const [selectedDayForTask, setSelectedDayForTask] = useState('');
      const [selectedTimeForTask, setSelectedTimeForTask] = useState('');
      const [selectedCategory, setSelectedCategory] = useState('workout');
      const [showHabitModal, setShowHabitModal] = useState(false);

      const calculateCompletion = () => {
        const currentDay = getCurrentDay();
        const todayTasks = schedule[currentDay] || [];
        const habitTotal = habits.length;
        const habitCompleted = habits.filter(h => h.completed).length;
        const tasksTotal = todayTasks.length;
        const tasksCompleted = todayTasks.filter(t => t.completed).length;
        const totalTasks = habitTotal + tasksTotal;
        const completedTasks = habitCompleted + tasksCompleted;
        return totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
      };

      useEffect(() => {
        Storage.set('habits', habits);
        Storage.set('streak', streak);
        Storage.set('level', level);
        Storage.set('points', points);
        Storage.set('schedule', schedule);
        setCompletedToday(calculateCompletion());
      }, [habits, streak, level, points, schedule]);

      const toggleHabit = (habitId) => {
        setHabits(prev => prev.map(h => {
          if (h.id === habitId) {
            const newCompleted = !h.completed;
            if (newCompleted) setPoints(p => p + 10);
            return { ...h, completed: newCompleted };
          }
          return h;
        }));
      };

      const addTask = (day, hour = null) => {
        setSelectedDayForTask(day);
        setSelectedCategory('workout');
        if (hour !== null) {
          setSelectedTimeForTask(hour.toString().padStart(2, '0') + ':00');
        } else {
          setSelectedTimeForTask('');
        }
        setShowTaskModal(true);
      };

      const toggleTask = (day, taskId) => {
        setSchedule(prev => ({
          ...prev,
          [day]: prev[day].map(task => {
            if (task.id === taskId) {
              const newCompleted = !task.completed;
              if (newCompleted) setPoints(p => p + 10);
              return { ...task, completed: newCompleted };
            }
            return task;
          })
        }));
      };

      const deleteTask = (day, taskId) => {
        if (confirm('×œ××—×•×§ ××ª ×”××˜×¨×” ×”×–×•?')) {
          setSchedule(prev => ({
            ...prev,
            [day]: prev[day].filter(task => task.id !== taskId)
          }));
        }
      };

      const deleteHabit = (habitId) => {
        if (confirm('×œ××—×•×§ ××ª ×”×”×¨×’×œ ×”×–×”?')) {
          setHabits(prev => prev.filter(h => h.id !== habitId));
        }
      };

      const addHabit = (title) => {
        const newHabit = {
          id: Date.now(),
          title: title.trim(),
          icon: '',
          completed: false
        };
        setHabits(prev => [...prev, newHabit]);
      };

      const canPlayFIFA = completedToday >= 80;

      return (
        <div style={{fontFamily: 'system-ui, -apple-system, sans-serif', direction: 'rtl', height: '100vh', display: 'flex', flexDirection: 'column', background: 'linear-gradient(180deg, #2d2d3f 0%, #1a1a2e 100%)', color: '#ffffff'}}>
          
          <div style={{background: '#1a1a1a', color: '#6b3fa0', padding: '6px 8px', textAlign: 'center', boxShadow: '0 2px 6px rgba(107,63,160,0.3)', borderBottom: '2px solid #6b3fa0'}}>
            <MomentumLogo />
            {streak > 0 && (
              <div style={{display: 'inline-block', background: 'linear-gradient(135deg, #6b3fa0, #8b5fbf)', color: 'white', padding: '4px 10px', borderRadius: '12px', fontWeight: 'bold', marginTop: '6px', fontSize: '11px'}}>
                {streak} ×™××™×
              </div>
            )}
          </div>

          <div style={{flex: 1, overflowY: 'auto', padding: '20px', paddingBottom: '100px'}}>
            
            {currentPage === 'dashboard' && (
              <>
                <h2 style={{marginBottom: '20px', color: '#ffffff', fontSize: '24px', fontWeight: 'bold', textAlign: 'center'}}>×”×¨×’×œ×™× ×™×•××™×™×</h2>
                
                <button onClick={() => setShowHabitModal(true)} style={{width: '100%', padding: '16px', border: 'none', borderRadius: '20px', background: 'linear-gradient(135deg, #667eea, #764ba2)', color: 'white', fontSize: '16px', fontWeight: 'bold', cursor: 'pointer', marginBottom: '15px', boxShadow: '0 6px 16px rgba(102, 126, 234, 0.3)'}}>+ ×”×•×¡×£ ×”×¨×’×œ</button>
                
                {habits.map(habit => (
                  <div key={habit.id} style={{
                    background: 'linear-gradient(145deg, #f0f0f5, #e0e0e8)',
                    borderRadius: '20px',
                    padding: '20px',
                    marginBottom: '15px',
                    boxShadow: habit.completed ? '0 8px 20px rgba(72, 187, 120, 0.3), inset 0 1px 0 rgba(255,255,255,0.5)' : '0 8px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.5)',
                    border: 'none',
                    position: 'relative',
                    overflow: 'hidden'
                  }}>
                    <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>
                      <div style={{display: 'flex', alignItems: 'center', gap: '15px', flex: 1}}>
                        <div style={{
                          width: '50px',
                          height: '50px',
                          borderRadius: '15px',
                          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          fontSize: '24px',
                          boxShadow: '0 4px 10px rgba(102, 126, 234, 0.3)'
                        }}>
                          {habit.id === 'reading' && 'ğŸ“–'}
                          {habit.id === 'water' && 'ğŸ’§'}
                          {habit.id === 'meals' && 'ğŸ½ï¸'}
                        </div>
                        <div>
                          <div style={{fontSize: '18px', fontWeight: 'bold', color: '#2d3748', marginBottom: '2px'}}>{habit.title}</div>
                          <div style={{fontSize: '12px', color: '#718096'}}>×”×™×•××™×™×</div>
                        </div>
                      </div>
                      <div style={{display: 'flex', gap: '8px', alignItems: 'center'}}>
                        <button 
                          onClick={() => toggleHabit(habit.id)} 
                          style={{
                            width: '100px',
                            padding: '12px 20px',
                            border: 'none',
                            borderRadius: '25px',
                            fontSize: '15px',
                            fontWeight: 'bold',
                            cursor: 'pointer',
                            background: habit.completed ? 'linear-gradient(135deg, #48bb78, #38a169)' : '#a0aec0',
                            color: 'white',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            gap: '6px',
                            boxShadow: habit.completed ? '0 4px 12px rgba(72, 187, 120, 0.4)' : '0 2px 8px rgba(0,0,0,0.1)',
                            transition: 'all 0.3s ease'
                          }}
                        >
                          {habit.completed && 'âœ“'} ×‘×•×¦×¢
                        </button>
                        <button 
                          onClick={() => deleteHabit(habit.id)} 
                          style={{
                            padding: '12px',
                            border: 'none',
                            borderRadius: '50%',
                            background: 'rgba(252, 129, 129, 0.9)',
                            color: 'white',
                            cursor: 'pointer',
                            fontSize: '16px',
                            width: '45px',
                            height: '45px',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            boxShadow: '0 2px 8px rgba(252, 129, 129, 0.3)'
                          }}
                        >
                          âœ•
                        </button>
                      </div>
                    </div>
                  </div>
                ))}

                <button onClick={() => addTask(getCurrentDay())} style={{width: '100%', padding: '16px', border: 'none', borderRadius: '20px', background: 'linear-gradient(135deg, #667eea, #764ba2)', color: 'white', fontSize: '16px', fontWeight: 'bold', cursor: 'pointer', marginBottom: '15px', marginTop: '10px', boxShadow: '0 6px 16px rgba(102, 126, 234, 0.3)'}}>+ ×”×•×¡×£ ××˜×¨×”</button>
                
                {(schedule[getCurrentDay()] || []).map(task => (
                  <div key={task.id} style={{
                    background: task.bgColor || 'linear-gradient(145deg, #f0f0f5, #e0e0e8)',
                    borderRadius: '20px',
                    padding: '18px',
                    marginBottom: '12px',
                    boxShadow: '0 6px 16px rgba(0,0,0,0.1), inset 0 1px 0 rgba(255,255,255,0.5)',
                    border: 'none',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '12px'
                  }}>
                    <button onClick={() => toggleTask(getCurrentDay(), task.id)} style={{
                      width: '40px',
                      height: '40px',
                      borderRadius: '50%',
                      border: 'none',
                      background: task.completed ? 'linear-gradient(135deg, #48bb78, #38a169)' : 'rgba(255,255,255,0.3)',
                      cursor: 'pointer',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      fontSize: '20px',
                      color: 'white',
                      boxShadow: task.completed ? '0 4px 12px rgba(72, 187, 120, 0.4)' : '0 2px 6px rgba(0,0,0,0.1)',
                      flexShrink: 0
                    }}>
                      {task.completed && 'âœ“'}
                    </button>
                    <div style={{flex: 1}}>
                      <div style={{fontSize: '16px', fontWeight: 'bold', textDecoration: task.completed ? 'line-through' : 'none', color: task.bgColor ? 'white' : '#2d3748'}}>{task.title}</div>
                      {task.time && <div style={{fontSize: '12px', color: task.bgColor ? 'rgba(255,255,255,0.8)' : '#718096', marginTop: '2px'}}>{task.time}</div>}
                    </div>
                    <button onClick={() => deleteTask(getCurrentDay(), task.id)} style={{padding: '8px 14px', border: 'none', borderRadius: '12px', background: 'rgba(252, 129, 129, 0.9)', color: 'white', cursor: 'pointer', fontSize: '13px', fontWeight: '600', boxShadow: '0 2px 8px rgba(252, 129, 129, 0.3)'}}>××—×§</button>
                  </div>
                ))}
              </>
            )}

            {currentPage === 'today' && (
              <div>
                <h2 style={{marginBottom: '20px', color: '#ffffff', fontSize: '24px', fontWeight: 'bold', textAlign: 'center'}}>×œ×•×– ×”×™×•× - {getCurrentDay()}</h2>
                
                <button onClick={() => addTask(getCurrentDay())} style={{width: '100%', padding: '14px', border: 'none', borderRadius: '10px', background: 'linear-gradient(135deg, #6b3fa0, #8b5fbf)', color: 'white', fontSize: '16px', fontWeight: 'bold', cursor: 'pointer', marginBottom: '20px'}}>+ ×”×•×¡×£ ×œ××©×™××•×ª ×”×™×•×</button>
                
                <div style={{background: '#1a1a1a', borderRadius: '15px', padding: '20px', boxShadow: '0 2px 10px rgba(107,63,160,0.3)', border: '1px solid #333'}}>
                  {Array.from({length: 19}, (_, index) => {
                    const hour = index + 5;
                    const hourTasks = (schedule[getCurrentDay()] || []).filter(task => {
                      if (!task.time) return false;
                      const taskHour = parseInt(task.time.split(':')[0]);
                      return taskHour === hour;
                    });
                    
                    return (
                      <div key={hour} style={{
                        borderBottom: '1px solid #333',
                        padding: '15px 10px',
                        minHeight: '60px',
                        display: 'flex',
                        alignItems: 'flex-start',
                        gap: '15px',
                        cursor: 'pointer',
                        transition: 'background 0.2s'
                      }}
                      onMouseEnter={e => e.currentTarget.style.background = '#0a0a0a'}
                      onMouseLeave={e => e.currentTarget.style.background = 'transparent'}
                      onClick={() => addTask(getCurrentDay(), hour)}>
                        <div style={{
                          fontSize: '16px',
                          fontWeight: 'bold',
                          color: '#6b3fa0',
                          minWidth: '70px',
                          paddingTop: '5px'
                        }}>
                          {hour.toString().padStart(2, '0')}:00
                        </div>
                        <div style={{flex: 1}}>
                          {hourTasks.length > 0 ? (
                            hourTasks.map(task => (
                              <div key={task.id} style={{
                                background: task.completed ? 'linear-gradient(135deg, #1a4d2e, #1a4d3e)' : (task.bgColor || 'linear-gradient(135deg, #6b3fa0, #8b5fbf)'),
                                color: 'white',
                                padding: '12px 15px',
                                borderRadius: '10px',
                                marginBottom: '8px',
                                cursor: 'pointer',
                                display: 'flex',
                                alignItems: 'center',
                                gap: '10px',
                                boxShadow: '0 2px 6px rgba(0,0,0,0.2)'
                              }}
                              onClick={(e) => {
                                e.stopPropagation();
                                toggleTask(getCurrentDay(), task.id);
                              }}>
                                <div style={{
                                  width: '24px',
                                  height: '24px',
                                  borderRadius: '50%',
                                  border: '2px solid white',
                                  background: task.completed ? '#28a745' : 'transparent',
                                  display: 'flex',
                                  alignItems: 'center',
                                  justifyContent: 'center',
                                  fontSize: '14px',
                                  flexShrink: 0
                                }}>
                                  {task.completed && 'âœ“'}
                                </div>
                                <div style={{flex: 1}}>
                                  <div style={{fontSize: '16px', fontWeight: 'bold', textDecoration: task.completed ? 'line-through' : 'none'}}>
                                    {task.title}
                                  </div>
                                  {task.time && (
                                    <div style={{fontSize: '12px', opacity: 0.9, marginTop: '2px'}}>
                                      {task.time}
                                    </div>
                                  )}
                                </div>
                                <button 
                                  onClick={(e) => {
                                    e.stopPropagation();
                                    deleteTask(getCurrentDay(), task.id);
                                  }}
                                  style={{
                                    background: 'rgba(220, 53, 69, 0.8)',
                                    border: 'none',
                                    borderRadius: '6px',
                                    padding: '6px 10px',
                                    color: 'white',
                                    cursor: 'pointer',
                                    fontSize: '12px',
                                    flexShrink: 0
                                  }}>
                                  ××—×§
                                </button>
                              </div>
                            ))
                          ) : (
                            <div style={{
                              color: '#6c757d',
                              fontSize: '14px',
                              fontStyle: 'italic',
                              paddingTop: '5px'
                            }}>
                              ×œ×—×¥ ×œ×”×•×¡×¤×ª ××©×™××”
                            </div>
                          )}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {currentPage === 'schedule' && (
              <div>
                <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px'}}>
                  <h2 style={{margin: 0, color: '#ffffff'}}>×œ×•×— ×–×× ×™× ×©×‘×•×¢×™</h2>
                  <button
                    onClick={() => {
                      setSelectedDayForTask(getCurrentDay());
                      setShowTaskModal(true);
                    }}
                    style={{
                      padding: '10px 20px',
                      border: 'none',
                      borderRadius: '10px',
                      background: 'linear-gradient(135deg, #6b3fa0, #8b5fbf)',
                      color: 'white',
                      fontSize: '14px',
                      fontWeight: 'bold',
                      cursor: 'pointer'
                    }}
                  >
                    âœï¸ ×”×•×¡×£ ××˜×¨×”
                  </button>
                </div>
                
                <div style={{background: '#1a1a1a', borderRadius: '15px', boxShadow: '0 2px 10px rgba(107,63,160,0.3)', overflow: 'auto', border: '1px solid #333'}}>
                  <div style={{display: 'grid', gridTemplateColumns: '70px repeat(7, 1fr)', borderBottom: '2px solid #333', position: 'sticky', top: 0, background: '#1a1a1a', zIndex: 10}}>
                    <div style={{padding: '15px 10px', background: '#0a0a0a', borderLeft: '1px solid #333', fontSize: '12px', color: '#6c757d'}}></div>
                    {daysOfWeek.map(day => {
                      const isToday = day === getCurrentDay();
                      return (
                        <div key={day} style={{
                          padding: '15px 10px',
                          textAlign: 'center',
                          fontWeight: 'bold',
                          fontSize: '14px',
                          color: isToday ? 'white' : '#ffffff',
                          background: isToday ? 'linear-gradient(135deg, #6b3fa0, #8b5fbf)' : '#0a0a0a',
                          borderLeft: '1px solid #333'
                        }}>
                          {day}
                          {isToday && <div style={{fontSize: '10px', marginTop: '2px'}}>×”×™×•×</div>}
                        </div>
                      );
                    })}
                  </div>

                  <div style={{maxHeight: '500px', overflowY: 'auto'}}>
                    {Array.from({length: 19}, (_, index) => {
                      const hour = index + 5;
                      return (
                        <div key={hour} style={{display: 'grid', gridTemplateColumns: '70px repeat(7, 1fr)', borderBottom: '1px solid #333', minHeight: '60px'}}>
                          <div style={{
                            padding: '10px',
                            textAlign: 'center',
                            fontSize: '13px',
                            fontWeight: 'bold',
                            color: '#9ca3af',
                            borderLeft: '1px solid #333',
                            background: '#0a0a0a',
                            display: 'flex',
                            alignItems: 'flex-start',
                            justifyContent: 'center'
                          }}>
                            {hour.toString().padStart(2, '0')}:00
                          </div>
                          
                          {daysOfWeek.map(day => {
                            const dayTasks = (schedule[day] || []).filter(task => {
                              if (!task.time) return false;
                              const taskHour = parseInt(task.time.split(':')[0]);
                              return taskHour === hour;
                            });
                            
                            return (
                              <div 
                                key={day}
                                style={{
                                  borderLeft: '1px solid #333',
                                  padding: '4px',
                                  cursor: 'pointer',
                                  transition: 'background 0.2s',
                                  minHeight: '60px',
                                  background: 'transparent'
                                }}
                                onMouseEnter={e => e.currentTarget.style.background = '#1a1a1a'}
                                onMouseLeave={e => e.currentTarget.style.background = 'transparent'}
                                onClick={(e) => {
                                  e.preventDefault();
                                  e.stopPropagation();
                                  addTask(day, hour);
                                }}
                              >
                                {dayTasks.map(task => (
                                  <div
                                    key={task.id}
                                    style={{
                                      background: task.completed ? 'linear-gradient(135deg, #28a745, #20c997)' : (task.bgColor || 'linear-gradient(135deg, #6b3fa0, #8b5fbf)'),
                                      color: 'white',
                                      padding: '6px 8px',
                                      borderRadius: '6px',
                                      marginBottom: '4px',
                                      fontSize: '11px',
                                      fontWeight: 'bold',
                                      cursor: 'pointer',
                                      boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
                                      overflow: 'hidden',
                                      textOverflow: 'ellipsis',
                                      whiteSpace: 'nowrap'
                                    }}
                                    onClick={(e) => {
                                      e.stopPropagation();
                                      toggleTask(day, task.id);
                                    }}
                                    title={`${task.title}${task.time ? ' - ' + task.time : ''}`}
                                  >
                                    <div style={{display: 'flex', alignItems: 'center', gap: '4px'}}>
                                      <span style={{flex: 1, overflow: 'hidden', textOverflow: 'ellipsis'}}>
                                        {task.title}
                                      </span>
                                      {task.completed && <span style={{fontSize: '10px'}}>âœ“</span>}
                                    </div>
                                  </div>
                                ))}
                              </div>
                            );
                          })}
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}

            {currentPage === 'tracking' && (
              <div>
                <h2 style={{marginBottom: '20px', color: '#ffffff', fontSize: '24px', fontWeight: 'bold', textAlign: 'center'}}>××¢×§×‘ ×–××Ÿ</h2>
                
                <div style={{marginBottom: '30px'}}>
                  <h3 style={{color: '#ffffff', fontSize: '18px', marginBottom: '15px', textAlign: 'center'}}>×”×™×•× - {getCurrentDay()}</h3>
                  {(() => {
                    const todayTasks = schedule[getCurrentDay()] || [];
                    const categoryStats = {};
                    let totalTime = 0;
                    
                    todayTasks.forEach(task => {
                      if (task.category && task.time) {
                        const category = taskCategories.find(c => c.id === task.category);
                        if (category) {
                          if (!categoryStats[task.category]) {
                            categoryStats[task.category] = {
                              name: category.name,
                              color: category.color,
                              bgColor: category.bgColor,
                              count: 0,
                              hours: 0
                            };
                          }
                          categoryStats[task.category].count++;
                          categoryStats[task.category].hours += 1;
                          totalTime += 1;
                        }
                      }
                    });

                    const categories = Object.values(categoryStats);
                    
                    if (categories.length === 0) {
                      return (
                        <div style={{
                          background: '#1a1a1a',
                          borderRadius: '15px',
                          padding: '30px',
                          textAlign: 'center',
                          color: '#9ca3af',
                          border: '1px solid #333'
                        }}>
                          ××™×Ÿ ××©×™××•×ª ×¢× ×§×˜×’×•×¨×™×•×ª ×œ×”×™×•×
                        </div>
                      );
                    }

                    return (
                      <>
                        <div style={{
                          background: '#1a1a1a',
                          borderRadius: '15px',
                          padding: '20px',
                          marginBottom: '15px',
                          border: '1px solid #333',
                          display: 'flex',
                          justifyContent: 'center',
                          alignItems: 'center'
                        }}>
                          <svg width="250" height="250" viewBox="0 0 250 250">
                            {(() => {
                              let currentAngle = -90;
                              return categories.map((cat, i) => {
                                const percentage = (cat.hours / totalTime) * 100;
                                const angle = (percentage / 100) * 360;
                                const startAngle = currentAngle;
                                const endAngle = currentAngle + angle;
                                currentAngle = endAngle;
                                
                                const startRad = (startAngle * Math.PI) / 180;
                                const endRad = (endAngle * Math.PI) / 180;
                                const x1 = 125 + 80 * Math.cos(startRad);
                                const y1 = 125 + 80 * Math.sin(startRad);
                                const x2 = 125 + 80 * Math.cos(endRad);
                                const y2 = 125 + 80 * Math.sin(endRad);
                                const largeArc = angle > 180 ? 1 : 0;
                                
                                return (
                                  <g key={i}>
                                    <path
                                      d={`M 125 125 L ${x1} ${y1} A 80 80 0 ${largeArc} 1 ${x2} ${y2} Z`}
                                      fill={cat.color}
                                      opacity="0.9"
                                    />
                                    {percentage > 5 && (
                                      <text
                                        x={125 + 45 * Math.cos((startAngle + angle / 2) * Math.PI / 180)}
                                        y={125 + 45 * Math.sin((startAngle + angle / 2) * Math.PI / 180)}
                                        fill="white"
                                        fontSize="11"
                                        fontWeight="bold"
                                        textAnchor="middle"
                                        dominantBaseline="middle"
                                      >
                                        {Math.round(percentage)}%
                                      </text>
                                    )}
                                  </g>
                                );
                              });
                            })()}
                            <circle cx="125" cy="125" r="50" fill="#1a1a1a" />
                            <text x="125" y="120" fill="white" fontSize="20" fontWeight="bold" textAnchor="middle">
                              {totalTime}
                            </text>
                            <text x="125" y="140" fill="#9ca3af" fontSize="12" textAnchor="middle">
                              ×©×¢×•×ª
                            </text>
                          </svg>
                        </div>

                        {categories.map((cat, i) => {
                          const percentage = ((cat.hours / totalTime) * 100).toFixed(1);
                          return (
                            <div key={i} style={{
                              background: '#1a1a1a',
                              borderRadius: '12px',
                              padding: '15px',
                              marginBottom: '10px',
                              border: '1px solid #333',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '12px'
                            }}>
                              <div style={{
                                width: '12px',
                                height: '12px',
                                borderRadius: '50%',
                                background: cat.color,
                                flexShrink: 0
                              }} />
                              <div style={{flex: 1}}>
                                <div style={{color: '#ffffff', fontWeight: 'bold', fontSize: '16px'}}>{cat.name}</div>
                                <div style={{color: '#9ca3af', fontSize: '12px'}}>{cat.count} ××©×™××•×ª</div>
                              </div>
                              <div style={{textAlign: 'left'}}>
                                <div style={{color: '#ffffff', fontWeight: 'bold', fontSize: '18px'}}>{percentage}%</div>
                                <div style={{color: '#9ca3af', fontSize: '12px'}}>{cat.hours} ×©×¢×•×ª</div>
                              </div>
                            </div>
                          );
                        })}
                      </>
                    );
                  })()}
                </div>

                <div>
                  <h3 style={{color: '#ffffff', fontSize: '18px', marginBottom: '15px', textAlign: 'center'}}>×”×©×‘×•×¢</h3>
                  {(() => {
                    const categoryStats = {};
                    let totalTime = 0;
                    
                    daysOfWeek.forEach(day => {
                      const dayTasks = schedule[day] || [];
                      dayTasks.forEach(task => {
                        if (task.category && task.time) {
                          const category = taskCategories.find(c => c.id === task.category);
                          if (category) {
                            if (!categoryStats[task.category]) {
                              categoryStats[task.category] = {
                                name: category.name,
                                color: category.color,
                                bgColor: category.bgColor,
                                count: 0,
                                hours: 0
                              };
                            }
                            categoryStats[task.category].count++;
                            categoryStats[task.category].hours += 1;
                            totalTime += 1;
                          }
                        }
                      });
                    });

                    const categories = Object.values(categoryStats);
                    
                    if (categories.length === 0) {
                      return (
                        <div style={{
                          background: '#1a1a1a',
                          borderRadius: '15px',
                          padding: '30px',
                          textAlign: 'center',
                          color: '#9ca3af',
                          border: '1px solid #333'
                        }}>
                          ××™×Ÿ ××©×™××•×ª ×¢× ×§×˜×’×•×¨×™×•×ª ×”×©×‘×•×¢
                        </div>
                      );
                    }

                    return (
                      <>
                        <div style={{
                          background: '#1a1a1a',
                          borderRadius: '15px',
                          padding: '20px',
                          marginBottom: '15px',
                          border: '1px solid #333',
                          display: 'flex',
                          justifyContent: 'center',
                          alignItems: 'center'
                        }}>
                          <svg width="250" height="250" viewBox="0 0 250 250">
                            {(() => {
                              let currentAngle = -90;
                              return categories.map((cat, i) => {
                                const percentage = (cat.hours / totalTime) * 100;
                                const angle = (percentage / 100) * 360;
                                const startAngle = currentAngle;
                                const endAngle = currentAngle + angle;
                                currentAngle = endAngle;
                                
                                const startRad = (startAngle * Math.PI) / 180;
                                const endRad = (endAngle * Math.PI) / 180;
                                const x1 = 125 + 80 * Math.cos(startRad);
                                const y1 = 125 + 80 * Math.sin(startRad);
                                const x2 = 125 + 80 * Math.cos(endRad);
                                const y2 = 125 + 80 * Math.sin(endRad);
                                const largeArc = angle > 180 ? 1 : 0;
                                
                                return (
                                  <g key={i}>
                                    <path
                                      d={`M 125 125 L ${x1} ${y1} A 80 80 0 ${largeArc} 1 ${x2} ${y2} Z`}
                                      fill={cat.color}
                                      opacity="0.9"
                                    />
                                    {percentage > 5 && (
                                      <text
                                        x={125 + 45 * Math.cos((startAngle + angle / 2) * Math.PI / 180)}
                                        y={125 + 45 * Math.sin((startAngle + angle / 2) * Math.PI / 180)}
                                        fill="white"
                                        fontSize="11"
                                        fontWeight="bold"
                                        textAnchor="middle"
                                        dominantBaseline="middle"
                                      >
                                        {Math.round(percentage)}%
                                      </text>
                                    )}
                                  </g>
                                );
                              });
                            })()}
                            <circle cx="125" cy="125" r="50" fill="#1a1a1a" />
                            <text x="125" y="120" fill="white" fontSize="20" fontWeight="bold" textAnchor="middle">
                              {totalTime}
                            </text>
                            <text x="125" y="140" fill="#9ca3af" fontSize="12" textAnchor="middle">
                              ×©×¢×•×ª
                            </text>
                          </svg>
                        </div>

                        {categories.map((cat, i) => {
                          const percentage = ((cat.hours / totalTime) * 100).toFixed(1);
                          return (
                            <div key={i} style={{
                              background: '#1a1a1a',
                              borderRadius: '12px',
                              padding: '15px',
                              marginBottom: '10px',
                              border: '1px solid #333',
                              display: 'flex',
                              alignItems: 'center',
                              gap: '12px'
                            }}>
                              <div style={{
                                width: '12px',
                                height: '12px',
                                borderRadius: '50%',
                                background: cat.color,
                                flexShrink: 0
                              }} />
                              <div style={{flex: 1}}>
                                <div style={{color: '#ffffff', fontWeight: 'bold', fontSize: '16px'}}>{cat.name}</div>
                                <div style={{color: '#9ca3af', fontSize: '12px'}}>{cat.count} ××©×™××•×ª</div>
                              </div>
                              <div style={{textAlign: 'left'}}>
                                <div style={{color: '#ffffff', fontWeight: 'bold', fontSize: '18px'}}>{percentage}%</div>
                                <div style={{color: '#9ca3af', fontSize: '12px'}}>{cat.hours} ×©×¢×•×ª</div>
                              </div>
                            </div>
                          );
                        })}
                      </>
                    );
                  })()}
                </div>
              </div>
            )}
          </div>

          {showTaskModal && (
            <div 
              style={{
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                background: 'rgba(0,0,0,0.6)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                zIndex: 2000,
                padding: '20px'
              }}
              onClick={() => setShowTaskModal(false)}
            >
              <div 
                style={{
                  background: '#1a1a1a',
                  borderRadius: '20px',
                  padding: '25px',
                  maxWidth: '450px',
                  width: '100%',
                  boxShadow: '0 10px 40px rgba(107,63,160,0.5)',
                  border: '1px solid #6b3fa0',
                  maxHeight: '90vh',
                  overflowY: 'auto'
                }}
                onClick={e => e.stopPropagation()}
              >
                <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px'}}>
                  <h2 style={{margin: 0, color: '#ffffff', fontSize: '20px'}}>×”×•×¡×£ ××˜×¨×” - ×™×•× {selectedDayForTask}</h2>
                  <button 
                    onClick={() => setShowTaskModal(false)}
                    style={{
                      background: 'none',
                      border: 'none',
                      fontSize: '32px',
                      cursor: 'pointer',
                      color: '#6c757d',
                      lineHeight: 1,
                      padding: 0
                    }}
                  >
                    Ã—
                  </button>
                </div>
                
                <form key={selectedDayForTask + selectedTimeForTask} onSubmit={(e) => {
                  e.preventDefault();
                  const formData = new FormData(e.target);
                  const title = formData.get('title');
                  const time = formData.get('time');
                  const category = taskCategories.find(c => c.id === selectedCategory);
                  
                  if (title && title.trim()) {
                    const newTask = {
                      id: Date.now(),
                      title: title.trim(),
                      time: time || '',
                      category: selectedCategory,
                      bgColor: category.bgColor,
                      color: category.color,
                      icon: '',
                      completed: false
                    };
                    
                    setSchedule(prev => ({
                      ...prev,
                      [selectedDayForTask]: [...(prev[selectedDayForTask] || []), newTask]
                    }));
                    
                    setShowTaskModal(false);
                    e.target.reset();
                  }
                }}>
                  <div style={{marginBottom: '20px'}}>
                    <input 
                      type="text"
                      name="title"
                      required
                      autoFocus
                      placeholder="×©× ×”××˜×¨×”..."
                      style={{
                        width: '100%',
                        padding: '15px',
                        border: 'none',
                        borderBottom: '2px solid #6b3fa0',
                        fontSize: '16px',
                        boxSizing: 'border-box',
                        outline: 'none',
                        fontWeight: '500',
                        background: '#0a0a0a',
                        color: '#ffffff'
                      }}
                    />
                  </div>

                  <div style={{marginBottom: '20px'}}>
                    <div style={{fontSize: '14px', color: '#9ca3af', marginBottom: '10px'}}>×§×˜×’×•×¨×™×”:</div>
                    <div style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '8px'}}>
                      {taskCategories.map(cat => (
                        <button
                          key={cat.id}
                          type="button"
                          onClick={() => setSelectedCategory(cat.id)}
                          style={{
                            padding: '10px',
                            border: selectedCategory === cat.id ? `2px solid ${cat.color}` : '2px solid #333',
                            borderRadius: '8px',
                            background: selectedCategory === cat.id ? cat.bgColor : '#0a0a0a',
                            color: 'white',
                            fontSize: '13px',
                            fontWeight: selectedCategory === cat.id ? 'bold' : 'normal',
                            cursor: 'pointer',
                            transition: 'all 0.2s'
                          }}
                        >
                          {cat.name}
                        </button>
                      ))}
                    </div>
                  </div>

                  <div style={{marginBottom: '30px'}}>
                    <div style={{display: 'flex', alignItems: 'center', gap: '10px', padding: '10px 0'}}>
                      <span style={{fontSize: '14px', color: '#9ca3af'}}>×©×¢×”:</span>
                      <input 
                        key={selectedTimeForTask}
                        type="time"
                        name="time"
                        defaultValue={selectedTimeForTask}
                        style={{
                          flex: 1,
                          padding: '12px',
                          border: '1px solid #333',
                          borderRadius: '8px',
                          fontSize: '14px',
                          boxSizing: 'border-box',
                          background: '#0a0a0a',
                          color: '#ffffff'
                        }}
                      />
                    </div>
                  </div>

                  <div style={{display: 'flex', gap: '10px'}}>
                    <button 
                      type="submit"
                      style={{
                        flex: 1,
                        padding: '14px',
                        border: 'none',
                        borderRadius: '10px',
                        fontSize: '16px',
                        fontWeight: 'bold',
                        cursor: 'pointer',
                        background: 'linear-gradient(135deg, #6b3fa0, #8b5fbf)',
                        color: 'white'
                      }}
                    >
                      ×©××™×¨×”
                    </button>
                  </div>
                </form>
              </div>
            </div>
          )}

          {showHabitModal && (
            <div 
              style={{
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                background: 'rgba(0,0,0,0.6)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                zIndex: 2000,
                padding: '20px'
              }}
              onClick={() => setShowHabitModal(false)}
            >
              <div 
                style={{
                  background: '#1a1a1a',
                  borderRadius: '20px',
                  padding: '25px',
                  maxWidth: '450px',
                  width: '100%',
                  boxShadow: '0 10px 40px rgba(107,63,160,0.5)',
                  border: '1px solid #6b3fa0'
                }}
                onClick={e => e.stopPropagation()}
              >
                <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '25px'}}>
                  <h2 style={{margin: 0, color: '#ffffff', fontSize: '20px'}}>×”×•×¡×£ ×”×¨×’×œ ×—×“×©</h2>
                  <button 
                    onClick={() => setShowHabitModal(false)}
                    style={{
                      background: 'none',
                      border: 'none',
                      fontSize: '32px',
                      cursor: 'pointer',
                      color: '#6c757d',
                      lineHeight: 1,
                      padding: 0
                    }}
                  >
                    Ã—
                  </button>
                </div>
                
                <form onSubmit={(e) => {
                  e.preventDefault();
                  const formData = new FormData(e.target);
                  const title = formData.get('habitTitle');
                  
                  if (title && title.trim()) {
                    addHabit(title);
                    setShowHabitModal(false);
                    e.target.reset();
                  }
                }}>
                  <div style={{marginBottom: '30px'}}>
                    <input 
                      type="text"
                      name="habitTitle"
                      required
                      autoFocus
                      placeholder="×©× ×”×”×¨×’×œ..."
                      style={{
                        width: '100%',
                        padding: '15px',
                        border: 'none',
                        borderBottom: '2px solid #6b3fa0',
                        fontSize: '16px',
                        boxSizing: 'border-box',
                        outline: 'none',
                        fontWeight: '500',
                        background: '#0a0a0a',
                        color: '#ffffff'
                      }}
                    />
                  </div>

                  <button 
                    type="submit"
                    style={{
                      width: '100%',
                      padding: '14px',
                      border: 'none',
                      borderRadius: '10px',
                      fontSize: '16px',
                      fontWeight: 'bold',
                      cursor: 'pointer',
                      background: 'linear-gradient(135deg, #6b3fa0, #8b5fbf)',
                      color: 'white'
                    }}
                  >
                    ×”×•×¡×£ ×”×¨×’×œ
                  </button>
                </form>
              </div>
            </div>
          )}

          <div style={{position: 'fixed', bottom: 0, left: 0, right: 0, background: 'rgba(45, 45, 63, 0.95)', backdropFilter: 'blur(10px)', display: 'flex', justifyContent: 'space-around', padding: '12px 0 20px 0', boxShadow: '0 -4px 20px rgba(0,0,0,0.2)', borderTop: '1px solid rgba(255,255,255,0.1)'}}>
            {[
              {id: 'dashboard', icon: '', label: 'TODO'},
              {id: 'today', icon: '', label: '×”×™×•×'},
              {id: 'schedule', icon: '', label: '×œ×•×–×™×'},
              {id: 'tracking', icon: '', label: '××¢×§×‘×™×'}
            ].map(item => (
              <button key={item.id} style={{flex: 1, textAlign: 'center', padding: '8px', border: 'none', background: currentPage === item.id ? 'rgba(102, 126, 234, 0.15)' : 'none', cursor: 'pointer', color: currentPage === item.id ? '#667eea' : '#a0aec0', borderRadius: '12px', transition: 'all 0.3s ease'}} onClick={() => setCurrentPage(item.id)}>
                <div style={{fontSize: '15px', fontWeight: '700'}}>{item.label}</div>
              </button>
            ))}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
